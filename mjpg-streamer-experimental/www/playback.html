<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN"
"http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
  <head>
    <title>PS42 Stream</title>
    <meta http-equiv="content-type" content="text/html; charset=iso-8859-1" />
    <link rel="stylesheet" href="style.css" type="text/css" />
    <link rel="stylesheet" href="./jquery-ui.css" />
    <script type="text/javascript" src="jquery.js"></script>    
    <script type="text/javascript" src="./jsfeat.js"></script>    
    <script type="text/javascript" src="jquery.rotate.js"></script>
    <script src="./jquery.min.js" type="text/javascript"></script> 
    <script src="./skulpt.min.js" type="text/javascript"></script> 
    <script src="./skulpt-stdlib.js" type="text/javascript"></script> 
    <link rel="stylesheet" href="jquery.checkbox.css" />
    <link rel="stylesheet" href="nouislider.min.css">
		<link rel="stylesheet" href="jquery.safari-checkbox.css" />
		<script type="text/javascript" src="jquery.js"></script>
		<script type="text/javascript" src="jquery.checkbox.min.js"></script>
		<script type="text/javascript">
			$(document).ready(function() {
				document.getElementById("main_data").style.visibility = "hidden";
				document.getElementById("selector1").style.visibility = "hidden";
			});

			displayForm = function (elementId)
			{
				var content = [];
				$('#' + elementId + ' input').each(function(){
					var el = $(this);
					if ( (el.attr('type').toLowerCase() == 'radio'))
					{
						if ( this.checked )
							content.push([
								'"', el.attr('name'), '": ',
								'value="', ( this.value ), '"',
								( this.disabled ? ', disabled' : '' )
							].join(''));
					}
					else
						content.push([
							'"', el.attr('name'), '": ',
							( this.checked ? 'checked' : 'not checked' ), 
							( this.disabled ? ', disabled' : '' )
						].join(''));
				});
				alert(content.join('\n'));
			}
			
			changeStyle = function(skin)
			{
				jQuery('#myform :checkbox').checkbox((skin ? {cls: skin} : {}));
			}
			
			
		</script>

	<style type="text/css">
body, html { padding: 0px; margin: 0px; background: #ccc; font-family: Arial;font-size: 13px;}
h1 {margin: 20px 0 0 0;padding: 0;color: #09f;font-size: 28px; text-align: center;font-weight: bold;}
h2 {margin: 25px 0 0 0;padding: 0;font-size: 20px;}
h3 {margin: 25px 0 0 0;padding: 0;font-size: 16px;}
p {clear: both;vertical-align: middle;font-size: 13px;margin: 10px 0 0 0;padding: 0;}
pre { display: block;margin: 0px;padding: 2px 2px 2px 2px; border: 1px solid #888; background: #ccc;}
code { display: block;margin: 0px;padding: 2px 2px 2px 20px;border: 1px solid #888;background: #fff;}
.hr { clear: both;margin: 20px 0 20px 0;font-size: 2px;line-height: 2px;background: #ccc;border: 1px solid #888;height: 2px;display: block;}
table {font-size: 13px;}
a {color: #069;}
a:hover{color: #e30;}
a.code{display: block;float:left;clear:both;padding: 2px 0px;}
label { cursor: hand; cursor: pointer;}
		</style>
  </head>

  <body onload="runit();">
  	<script src="jquery.min.js"></script>
  	<script src="nouislider.min.js"></script>
	<script type="text/javascript">
	  var json_data;
	  
	  var slider = document.getElementById('slider');
	  
	  noUiSlider.create(slider, {
	  	start: [0],
		range: {
			'min': 0,
			'max': 100
		}
	});
	  
	  function runit() { 
		$(document).ready(function()
			{
				$.getJSON('db.json', function(json)
					{
						json_data = json;
						console.log(json);
						$("select#selector1").append( $("<option>").val("none").html("select a run"));
						Object.keys(json_data).forEach(function(k) {
							if(k !== "_default"){
								$("select#selector1").append( $("<option>")
									.val(k)
									.html(k)
								);
							}
							document.getElementById("selector1").style.visibility = "visible";
						});
					});
			});
	    
	  }
	  function loadData(sel)
	  {
	  	var value = sel.value;
		var data = json_data[value];
		var key, count = 0;
		for(key in data)
		{
			count++;
		}
		document.getElementById("main_data").style.visibility = "visible";
		$(function(){
	
			var currentValue = $('#currentValue');
	
			$("#slider").slider({ 
				max: count,
				min: 0,
				slide: function(event, ui) {
					var img_src = "data:image/png;base64,".concat(data[ui.value]['image']);
					document.getElementById("streamimage").src = img_src;
					var batt = "Battery: ".concat(data[ui.value]['battery']);
                                        document.getElementById("batt").innerHTML = batt;
					var hum = "Humidity: ".concat(data[ui.value]['humidity']);
                                        document.getElementById("hum").innerHTML = hum;
					var dep = "Depth: ".concat(data[ui.value]['depth']);
                                        document.getElementById("dep").innerHTML = dep;
					var hull_temp = "Hull Temp: ".concat(data[ui.value]['hulltemp']);
                                        document.getElementById("hull_temp").innerHTML = hull_temp;
					var pitch = "Pitch: ".concat(data[ui.value]['pitch']);
                                        document.getElementById("pitch").innerHTML = pitch;
					var roll = "Roll: ".concat(data[ui.value]['roll']);
                                        document.getElementById("roll").innerHTML = roll;
					var temp = "Temp: ".concat(data[ui.value]['watertemp']);
                                        document.getElementById("temp").innerHTML = temp;
					var head = "Heading: ".concat(data[ui.value]['heading']);
                                        document.getElementById("head").innerHTML = head;
					var yaw = "Yaw: ".concat(data[ui.value]['yaw']);
                                        document.getElementById("yaw").innerHTML = yaw;
				}
			});
	
		});		
		
	  } 
	  
	</script>
    <div id="sidebar">
      <h1>WeGo Moore - Project NEMO</h1>
      <h2>PS42 Live Video Stream</h2>

      <div id="menu">
        <a href="index.html">Home</a>
        <a href="stream.html">Stream</a> 
        <a class="active" href=playback.html">Playback</a> 
	
      </div>

    </div>

    <div id="content">
      <h1>Playback</h1>
      <h2>Display the recorded data</h2>
	<select size="1" id="selector1" onChange="loadData(this)"></select>
	<div class="imgHolder" id="main_data">
    		<img id="streamimage" class="xform" />
    		<temp id="temp">Temp: XX</temp>
		<humidity id="hum">Humidity: XX</humidity>
		<depth id="dep">Depth: XX</depth>
		<hull_temp id="hull_temp">Hull Temp: XX</hull_temp>
		<battery id="batt">Battery: XX</battery>
		<heading id="head">Heading: XX</heading>
		<bot>.</bot>
		<div class="imu">
			<roll id="roll">Roll: XX</roll>
			<pitch id="pitch">Pitch: XX</pitch>
			<yaw id="yaw">Yaw: XX</yaw>
			<inches id="inches" hidden>10</inches>
		</div>
		<div id="slider"></div>
		</div>
		</br>
		<br/>
		<button onclick="myFunction()">Download All Runs</button>

<script>
function myFunction() {
    window.open("./db.json");
}
</script>
	
	
	</br>
	
	
	<br /> 
	</div>
	<br/>	
	<script src="./jquery-1.7.1.min.js"></script>
	<script src="./jquery-ui.min.js"></script>

	
	
	
	
  </body>
</html>
